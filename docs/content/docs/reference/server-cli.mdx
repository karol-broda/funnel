---
title: server cli & tls
icon: TerminalWindowIcon
description: a reference for all `funnel-server` command-line flags and how to configure tls.
---

import { Callout } from 'fumadocs-ui/components/callout';
import { Accordion, Accordions } from 'fumadocs-ui/components/accordion';

<Callout title="docker only" intent="warning">
the funnel server runs exclusively as a docker container for easy deployment and management.
</Callout>

## running the server

basic command to start the server:

```bash
docker run -d --name funnel-server [options] ghcr.io/karol-broda/funnel-server:latest
```

## configuration

<Accordions>
<Accordion title="Environment Variables">
| variable | default | description |
| --- | --- | --- |
| `FUNNEL_PORT` | `8080` | http traffic port |
| `FUNNEL_HOST` | `0.0.0.0` | host interface to bind |
| `FUNNEL_ENABLE_TLS` | `false` | enable automatic tls |
| `FUNNEL_TLS_PORT` | `8443` | https traffic port |
| `FUNNEL_LETSENCRYPT_EMAIL` | - | email for let's encrypt (required for tls) |
| `FUNNEL_CERT_DIR` | `/var/lib/funnel/certs` | certificate storage directory |
| `FUNNEL_DNS_PROVIDERS_CONFIG` | - | dns provider config path (required for tls) |
</Accordion>

<Accordion title="Command Line Flags">
alternatively, pass flags directly to the container:

| flag | shorthand | description |
| --- | --- | --- |
| `--port` | `-p` | http traffic port |
| `--enable-tls` | - | enable automatic tls |
| `--tls-port` | - | https traffic port |
| `--letsencrypt-email` | - | email for let's encrypt |
| `--cert-dir` | - | certificate storage directory |
| `--dns-providers-config` | - | dns provider config path |
| `--help` | `-h` | show help |
</Accordion>
</Accordions>

## examples

basic server:
```bash
docker run -d --name funnel-server -p 8080:8080 ghcr.io/karol-broda/funnel-server:latest
```

server with custom port:
```bash
docker run -d --name funnel-server -p 9000:9000 -e FUNNEL_PORT=9000 ghcr.io/karol-broda/funnel-server:latest
```

## tls configuration

<Callout title="automatic tls" intent="info">
funnel automatically provisions and renews tls certificates from let's encrypt using the dns-01 challenge.
</Callout>

### setup steps

1. **create dns provider config** - see [lego documentation](https://go-acme.github.io/lego/dns/)

```json title="dns-providers.json"
{
  "providers": [
    {
      "name": "cloudflare",
      "env": {
        "CF_API_TOKEN": "your-cloudflare-api-token"
      }
    }
  ]
}
```

2. **start with tls enabled**

```bash
docker run -d --name funnel-server \
  -p 8080:8080 \
  -p 8443:8443 \
  -v $(pwd)/dns-providers.json:/etc/funnel/dns-providers.json \
  -v funnel-certs:/var/lib/funnel/certs \
  -e FUNNEL_ENABLE_TLS=true \
  -e FUNNEL_LETSENCRYPT_EMAIL=your-email@example.com \
  -e FUNNEL_DNS_PROVIDERS_CONFIG=/etc/funnel/dns-providers.json \
  ghcr.io/karol-broda/funnel-server:latest
```

certificates are generated automatically on first request and renewed before expiration. 