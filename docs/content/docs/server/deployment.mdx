---
title: deployment
icon: PackageIcon
---
import { Step, Steps } from 'fumadocs-ui/components/steps';

This guide will walk you through deploying the funnel server using Docker.

## prerequisites

- Docker installed on your machine.
- A domain name for your server (for TLS/HTTPS tunnels).
- DNS provider credentials for automatic TLS certificate generation (optional but recommended).

## docker deployment

The recommended way to deploy the server is using the official Docker image.

<Steps>

<Step>
### create a volume for certificates

The server needs to persist TLS certificates. Create a Docker volume to store them.

```bash
docker volume create funnel-certs
```
</Step>

<Step>
### basic deployment

For a basic deployment without TLS, you can run:

```bash
docker run -d --name funnel-server \
  -p 8080:8080 \
  --restart unless-stopped \
  ghcr.io/karol-broda/funnel-server:latest
```

This will start the server on port 8080 and make it accessible at `http://your-server-ip:8080`.
</Step>

<Step>
### deployment with TLS (recommended)

For a production deployment with automatic TLS certificates, you'll need to provide your domain name and DNS provider configuration.

First, create a DNS provider configuration file (see the [Server CLI Reference](/docs/reference/server-cli) for details):

```json title="dns-providers.json"
{
  "providers": [
    {
      "name": "cloudflare",
      "env": {
        "CF_API_TOKEN": "your-cloudflare-api-token"
      }
    }
  ]
}
```

Then run the server with TLS enabled:

```bash
docker run -d --name funnel-server \
  -p 80:8080 \
  -p 443:8443 \
  -v $(pwd)/dns-providers.json:/etc/funnel/dns-providers.json \
  -v funnel-certs:/var/lib/funnel/certs \
  -e FUNNEL_ENABLE_TLS=true \
  -e FUNNEL_LETSENCRYPT_EMAIL=your-email@example.com \
  -e FUNNEL_DNS_PROVIDERS_CONFIG=/etc/funnel/dns-providers.json \
  --restart unless-stopped \
  ghcr.io/karol-broda/funnel-server:latest
```

Replace `your-email@example.com` with your actual email address.
</Step>

<Step>
### verify the deployment

Check the logs to ensure the server started correctly:

```bash
docker logs -f funnel-server
```

You should see logs indicating that the server is listening on the configured ports. If TLS is enabled, you'll also see logs about certificate generation.

</Step>
</Steps>

## configuration

The server can be configured using environment variables:

| Variable | Description | Default |
| --- | --- | --- |
| `FUNNEL_HOST` | The host to listen on. | `0.0.0.0` |
| `FUNNEL_PORT` | The port for HTTP traffic. | `8080` |
| `FUNNEL_TLS_PORT` | The port for HTTPS/TLS traffic. | `8443` |
| `FUNNEL_ENABLE_TLS` | Enable automatic TLS certificate generation. | `false` |
| `FUNNEL_LETSENCRYPT_EMAIL` | Email address for Let's Encrypt account (required for TLS). | `""` |
| `FUNNEL_DNS_PROVIDERS_CONFIG` | Path to the DNS provider config file (required for TLS). | `""` |
| `FUNNEL_CERT_DIR` | Directory to store TLS certificates. | `/var/lib/funnel/certs` |

## docker compose (alternative)

You can also use Docker Compose for easier management:

```yaml title="docker-compose.yml"
version: '3.8'
services:
  funnel-server:
    image: ghcr.io/karol-broda/funnel-server:latest
    container_name: funnel-server
    ports:
      - "80:8080"
      - "443:8443"
    volumes:
      - ./dns-providers.json:/etc/funnel/dns-providers.json
      - funnel-certs:/var/lib/funnel/certs
    environment:
      - FUNNEL_ENABLE_TLS=true
      - FUNNEL_LETSENCRYPT_EMAIL=your-email@example.com
      - FUNNEL_DNS_PROVIDERS_CONFIG=/etc/funnel/dns-providers.json
    restart: unless-stopped

volumes:
  funnel-certs:
```

Then run:
```bash
docker-compose up -d
```

For a complete list of configuration options, please refer to the [Server CLI Reference](/docs/reference/server-cli). 